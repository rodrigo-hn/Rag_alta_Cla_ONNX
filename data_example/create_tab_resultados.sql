-- Script para crear tabla TAB_RESULTADOS en Oracle 19c
-- Basado en el archivo d_res.txt

-- Eliminar la tabla si existe (opcional)
-- DROP TABLE TAB_RESULTADOS CASCADE CONSTRAINTS;

-- Crear la tabla
CREATE TABLE TAB_RESULTADOS (
    COD_EMPRESA NUMBER(2),
    COD_SUCURSAL NUMBER(2),
    ORIGEN_SOLICITUD VARCHAR2(50),
    ID_ATENCION NUMBER(10),
    NRO_PETICION_LIS NUMBER(10),
    ID_REGISTRO NUMBER(5),
    COD_PRESTACION VARCHAR2(20),
    CORR_PRUEBA_LIS NUMBER(5),
    NOMBRE_PRUEBA_LIS VARCHAR2(200),
    VALOR_RESULTADO VARCHAR2(500),
    UNIDAD_MEDIDA VARCHAR2(50),
    RANGO_INFERIOR VARCHAR2(20),
    RANGO_SUPERIOR VARCHAR2(20),
    OBSERVACION CLOB,
    ID_TECNOLOGO VARCHAR2(20),
    FECHA_FIRMA TIMESTAMP,
    FECHA_INTEGRACION TIMESTAMP,
    RUT_TECNOLOGO NUMBER(10),
    DV_TECNOLOGO VARCHAR2(1),
    APEPAT_TECNOLOGO VARCHAR2(100),
    APEMAT_TECNOLOGO VARCHAR2(100),
    NOMBRE_TECNOLOGO VARCHAR2(100),
    VALOR_INFERIOR_IMP VARCHAR2(20),
    VALOR_SUPERIOR_IMP VARCHAR2(20),
    FECHA_INGRESO_INFORME_CRITICO TIMESTAMP,
    FECHA_INFORME_CRITICO TIMESTAMP,
    OBSERVACION_CRITICA VARCHAR2(500),
    ESTADO_NOTIFICACION_CRITICA VARCHAR2(50),
    IND_RANGO_RESULTADO VARCHAR2(1),
    ID_PRUEBA_LIS NUMBER(10)
);

-- Comentarios de la tabla
COMMENT ON TABLE TAB_RESULTADOS IS 'Tabla de resultados de exámenes de laboratorio';
COMMENT ON COLUMN TAB_RESULTADOS.COD_EMPRESA IS 'Código de empresa';
COMMENT ON COLUMN TAB_RESULTADOS.COD_SUCURSAL IS 'Código de sucursal';
COMMENT ON COLUMN TAB_RESULTADOS.ID_ATENCION IS 'ID de atención médica';
COMMENT ON COLUMN TAB_RESULTADOS.NRO_PETICION_LIS IS 'Número de petición LIS';
COMMENT ON COLUMN TAB_RESULTADOS.COD_PRESTACION IS 'Código de prestación';
COMMENT ON COLUMN TAB_RESULTADOS.NOMBRE_PRUEBA_LIS IS 'Nombre de la prueba de laboratorio';
COMMENT ON COLUMN TAB_RESULTADOS.VALOR_RESULTADO IS 'Valor del resultado';
COMMENT ON COLUMN TAB_RESULTADOS.IND_RANGO_RESULTADO IS 'Indicador de rango: N=Normal, H=Alto, L=Bajo';

-- Insertar los registros
INSERT INTO TAB_RESULTADOS VALUES (6,1,NULL,1416169,15617,1,'03-01-045-00',1,'Serie roja','-',NULL,NULL,NULL,NULL,NULL,TO_TIMESTAMP('25/12/2025 07:09:55','DD/MM/YYYY HH24:MI:SS'),TO_TIMESTAMP('25/12/2025 07:11:09','DD/MM/YYYY HH24:MI:SS'),18266673,'4',NULL,NULL,'TM. Claudia Roj',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL);

INSERT INTO TAB_RESULTADOS VALUES (6,1,NULL,1416169,15617,1,'03-01-045-00',2,'Recuento eritrocitos (absoluto)','2.51','x10^6/uL','4.10','5.10',NULL,NULL,TO_TIMESTAMP('25/12/2025 07:09:55','DD/MM/YYYY HH24:MI:SS'),TO_TIMESTAMP('25/12/2025 07:11:09','DD/MM/YYYY HH24:MI:SS'),18266673,'4',NULL,NULL,'TM. Claudia Roj',NULL,NULL,NULL,NULL,NULL,NULL,'L',NULL);

INSERT INTO TAB_RESULTADOS VALUES (6,1,NULL,1416169,15617,1,'03-01-045-00',3,'Hemoglobina en sangre total','7.8','g/dL','12.3','15.3',NULL,NULL,TO_TIMESTAMP('25/12/2025 07:09:55','DD/MM/YYYY HH24:MI:SS'),TO_TIMESTAMP('25/12/2025 07:11:09','DD/MM/YYYY HH24:MI:SS'),18266673,'4',NULL,NULL,'TM. Claudia Roj',NULL,NULL,NULL,NULL,NULL,NULL,'L',NULL);

INSERT INTO TAB_RESULTADOS VALUES (6,1,NULL,1416169,15617,1,'03-01-045-00',4,'Hematocrito','23.7','%','35.0','47.0',NULL,NULL,TO_TIMESTAMP('25/12/2025 07:09:55','DD/MM/YYYY HH24:MI:SS'),TO_TIMESTAMP('25/12/2025 07:11:09','DD/MM/YYYY HH24:MI:SS'),18266673,'4',NULL,NULL,'TM. Claudia Roj',NULL,NULL,NULL,NULL,NULL,NULL,'L',NULL);

INSERT INTO TAB_RESULTADOS VALUES (6,1,NULL,1416169,15617,1,'03-01-045-00',5,'V.C.M.','94.4','fL','80.0','96.0',NULL,NULL,TO_TIMESTAMP('25/12/2025 07:09:55','DD/MM/YYYY HH24:MI:SS'),TO_TIMESTAMP('25/12/2025 07:11:09','DD/MM/YYYY HH24:MI:SS'),18266673,'4',NULL,NULL,'TM. Claudia Roj',NULL,NULL,NULL,NULL,NULL,NULL,'N',NULL);

INSERT INTO TAB_RESULTADOS VALUES (6,1,NULL,1416169,15617,1,'03-01-045-00',6,'H.C.M.','31.1','pg','28.0','33.0',NULL,NULL,TO_TIMESTAMP('25/12/2025 07:09:55','DD/MM/YYYY HH24:MI:SS'),TO_TIMESTAMP('25/12/2025 07:11:09','DD/MM/YYYY HH24:MI:SS'),18266673,'4',NULL,NULL,'TM. Claudia Roj',NULL,NULL,NULL,NULL,NULL,NULL,'N',NULL);

INSERT INTO TAB_RESULTADOS VALUES (6,1,NULL,1416169,15617,1,'03-01-045-00',7,'C.H.C.M.','32.9','g/dL','32.0','36.0',NULL,NULL,TO_TIMESTAMP('25/12/2025 07:09:55','DD/MM/YYYY HH24:MI:SS'),TO_TIMESTAMP('25/12/2025 07:11:09','DD/MM/YYYY HH24:MI:SS'),18266673,'4',NULL,NULL,'TM. Claudia Roj',NULL,NULL,NULL,NULL,NULL,NULL,'N',NULL);

INSERT INTO TAB_RESULTADOS VALUES (6,1,NULL,1416169,15617,1,'03-01-045-00',8,'RDW-CV','21.5','%','11.7','14.4',NULL,NULL,TO_TIMESTAMP('25/12/2025 07:09:55','DD/MM/YYYY HH24:MI:SS'),TO_TIMESTAMP('25/12/2025 07:11:09','DD/MM/YYYY HH24:MI:SS'),18266673,'4',NULL,NULL,'TM. Claudia Roj',NULL,NULL,NULL,NULL,NULL,NULL,'H',NULL);

INSERT INTO TAB_RESULTADOS VALUES (6,1,NULL,1416169,15617,1,'03-01-045-00',9,'Serie blanca','-',NULL,NULL,NULL,NULL,NULL,TO_TIMESTAMP('25/12/2025 07:09:55','DD/MM/YYYY HH24:MI:SS'),TO_TIMESTAMP('25/12/2025 07:11:09','DD/MM/YYYY HH24:MI:SS'),18266673,'4',NULL,NULL,'TM. Claudia Roj',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL);

INSERT INTO TAB_RESULTADOS VALUES (6,1,NULL,1416169,15617,1,'03-01-045-00',10,'Recuento de leucocitos (absoluto)','12.62','x10^9/L','4.40','11.30',NULL,NULL,TO_TIMESTAMP('25/12/2025 07:09:55','DD/MM/YYYY HH24:MI:SS'),TO_TIMESTAMP('25/12/2025 07:11:09','DD/MM/YYYY HH24:MI:SS'),18266673,'4',NULL,NULL,'TM. Claudia Roj',NULL,NULL,NULL,NULL,NULL,NULL,'H',NULL);

INSERT INTO TAB_RESULTADOS VALUES (6,1,NULL,1416169,15617,1,'03-01-045-00',11,'Recuento de neutrófilos (absoluto)','9.47','x10^3/uL','2.00','7.15',NULL,NULL,TO_TIMESTAMP('25/12/2025 07:09:55','DD/MM/YYYY HH24:MI:SS'),TO_TIMESTAMP('25/12/2025 07:11:09','DD/MM/YYYY HH24:MI:SS'),18266673,'4',NULL,NULL,'TM. Claudia Roj',NULL,NULL,NULL,NULL,NULL,NULL,'H',NULL);

INSERT INTO TAB_RESULTADOS VALUES (6,1,NULL,1416169,15617,1,'03-01-045-00',12,'Recuento de linfocitos (absoluto)','1.43','x10^3/uL','1.16','3.18',NULL,NULL,TO_TIMESTAMP('25/12/2025 07:09:55','DD/MM/YYYY HH24:MI:SS'),TO_TIMESTAMP('25/12/2025 07:11:09','DD/MM/YYYY HH24:MI:SS'),18266673,'4',NULL,NULL,'TM. Claudia Roj',NULL,NULL,NULL,NULL,NULL,NULL,'N',NULL);

INSERT INTO TAB_RESULTADOS VALUES (6,1,NULL,1416169,15617,1,'03-01-045-00',13,'Serie plaquetaria','-',NULL,NULL,NULL,NULL,NULL,TO_TIMESTAMP('25/12/2025 07:09:55','DD/MM/YYYY HH24:MI:SS'),TO_TIMESTAMP('25/12/2025 07:11:09','DD/MM/YYYY HH24:MI:SS'),18266673,'4',NULL,NULL,'TM. Claudia Roj',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL);

INSERT INTO TAB_RESULTADOS VALUES (6,1,NULL,1416169,15617,1,'03-01-045-00',14,'Recuento de plaquetas (absoluto)','170','x10^3/uL','150','450',NULL,NULL,TO_TIMESTAMP('25/12/2025 07:09:55','DD/MM/YYYY HH24:MI:SS'),TO_TIMESTAMP('25/12/2025 07:11:09','DD/MM/YYYY HH24:MI:SS'),18266673,'4',NULL,NULL,'TM. Claudia Roj',NULL,NULL,NULL,NULL,NULL,NULL,'N',NULL);

INSERT INTO TAB_RESULTADOS VALUES (6,1,NULL,1416169,15617,1,'03-01-045-00',15,'V.P.M.','10','fL','8','13',NULL,NULL,TO_TIMESTAMP('25/12/2025 07:09:55','DD/MM/YYYY HH24:MI:SS'),TO_TIMESTAMP('25/12/2025 07:11:09','DD/MM/YYYY HH24:MI:SS'),18266673,'4',NULL,NULL,'TM. Claudia Roj',NULL,NULL,NULL,NULL,NULL,NULL,'N',NULL);

INSERT INTO TAB_RESULTADOS VALUES (6,1,NULL,1416169,15617,1,'03-01-045-00',16,'Serie VHS','-',NULL,NULL,NULL,NULL,NULL,TO_TIMESTAMP('25/12/2025 07:09:55','DD/MM/YYYY HH24:MI:SS'),TO_TIMESTAMP('25/12/2025 07:11:09','DD/MM/YYYY HH24:MI:SS'),18266673,'4',NULL,NULL,'TM. Claudia Roj',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL);

INSERT INTO TAB_RESULTADOS VALUES (6,1,NULL,1416169,15617,1,'03-01-045-00',17,'Velocidad de sedimentación','2','mm/hr','0','30',NULL,NULL,TO_TIMESTAMP('25/12/2025 07:09:55','DD/MM/YYYY HH24:MI:SS'),TO_TIMESTAMP('25/12/2025 07:11:09','DD/MM/YYYY HH24:MI:SS'),18266673,'4',NULL,NULL,'TM. Claudia Roj',NULL,NULL,NULL,NULL,NULL,NULL,'N',NULL);

INSERT INTO TAB_RESULTADOS VALUES (6,1,NULL,1416169,15617,1,'03-01-045-00',18,'Basófilos','0.3','%','0.0','1.0',NULL,NULL,TO_TIMESTAMP('25/12/2025 07:09:55','DD/MM/YYYY HH24:MI:SS'),TO_TIMESTAMP('25/12/2025 07:11:09','DD/MM/YYYY HH24:MI:SS'),18266673,'4',NULL,NULL,'TM. Claudia Roj',NULL,NULL,NULL,NULL,NULL,NULL,'N',1);

INSERT INTO TAB_RESULTADOS VALUES (6,1,NULL,1416169,15617,1,'03-01-045-00',19,'Eosinófilos','4.6','%','0.0','3.0',NULL,NULL,TO_TIMESTAMP('25/12/2025 07:09:55','DD/MM/YYYY HH24:MI:SS'),TO_TIMESTAMP('25/12/2025 07:11:09','DD/MM/YYYY HH24:MI:SS'),18266673,'4',NULL,NULL,'TM. Claudia Roj',NULL,NULL,NULL,NULL,NULL,NULL,'H',2);

INSERT INTO TAB_RESULTADOS VALUES (6,1,NULL,1416169,15617,1,'03-01-045-00',20,'Segmentados','76.2','%','50.0','70.0',NULL,NULL,TO_TIMESTAMP('25/12/2025 07:09:55','DD/MM/YYYY HH24:MI:SS'),TO_TIMESTAMP('25/12/2025 07:11:09','DD/MM/YYYY HH24:MI:SS'),18266673,'4',NULL,NULL,'TM. Claudia Roj',NULL,NULL,NULL,NULL,NULL,NULL,'H',3);

INSERT INTO TAB_RESULTADOS VALUES (6,1,NULL,1416169,15617,1,'03-01-045-00',21,'Linfocitos','11.3','%','25.0','40.0',NULL,NULL,TO_TIMESTAMP('25/12/2025 07:09:55','DD/MM/YYYY HH24:MI:SS'),TO_TIMESTAMP('25/12/2025 07:11:10','DD/MM/YYYY HH24:MI:SS'),18266673,'4',NULL,NULL,'TM. Claudia Roj',NULL,NULL,NULL,NULL,NULL,NULL,'L',4);

INSERT INTO TAB_RESULTADOS VALUES (6,1,NULL,1416169,15617,1,'03-01-045-00',22,'Monocitos','7.6','%','4.3','11.0',NULL,NULL,TO_TIMESTAMP('25/12/2025 07:09:55','DD/MM/YYYY HH24:MI:SS'),TO_TIMESTAMP('25/12/2025 07:11:10','DD/MM/YYYY HH24:MI:SS'),18266673,'4',NULL,NULL,'TM. Claudia Roj',NULL,NULL,NULL,NULL,NULL,NULL,'N',5);

INSERT INTO TAB_RESULTADOS VALUES (6,1,NULL,1416169,15617,1,'03-01-045-00',23,'Total','100','%','100','100',NULL,NULL,TO_TIMESTAMP('25/12/2025 07:09:55','DD/MM/YYYY HH24:MI:SS'),TO_TIMESTAMP('25/12/2025 07:11:10','DD/MM/YYYY HH24:MI:SS'),18266673,'4',NULL,NULL,'TM. Claudia Roj',NULL,NULL,NULL,NULL,NULL,NULL,'N',6);

INSERT INTO TAB_RESULTADOS VALUES (6,1,NULL,1416169,15617,1,'03-01-045-00',24,'Características morfológicas','-',NULL,NULL,NULL,NULL,NULL,TO_TIMESTAMP('25/12/2025 07:09:55','DD/MM/YYYY HH24:MI:SS'),TO_TIMESTAMP('25/12/2025 07:11:10','DD/MM/YYYY HH24:MI:SS'),18266673,'4',NULL,NULL,'TM. Claudia Roj',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL);

INSERT INTO TAB_RESULTADOS VALUES (6,1,NULL,1416169,15617,1,'03-01-045-00',25,'Eritrocitaria','Anisocitosis ++, Microcitosis ++, Macrocitosis +
Anisocromía +, Hipocromía +, Policromatofilia +
Poiquilocitosis +, Eliptocitos +',NULL,NULL,NULL,NULL,NULL,TO_TIMESTAMP('25/12/2025 07:09:55','DD/MM/YYYY HH24:MI:SS'),TO_TIMESTAMP('25/12/2025 07:11:10','DD/MM/YYYY HH24:MI:SS'),18266673,'4',NULL,NULL,'TM. Claudia Roj',NULL,NULL,NULL,NULL,NULL,NULL,'N',NULL);

INSERT INTO TAB_RESULTADOS VALUES (6,1,NULL,1416169,15617,1,'03-01-045-00',26,'Leucocitaria','Normales al frotis.',NULL,NULL,NULL,NULL,NULL,TO_TIMESTAMP('25/12/2025 07:09:55','DD/MM/YYYY HH24:MI:SS'),TO_TIMESTAMP('25/12/2025 07:11:10','DD/MM/YYYY HH24:MI:SS'),18266673,'4',NULL,NULL,'TM. Claudia Roj',NULL,NULL,NULL,NULL,NULL,NULL,'N',NULL);

INSERT INTO TAB_RESULTADOS VALUES (6,1,NULL,1416169,15617,1,'03-01-045-00',27,'Plaquetaria','Normales al frotis.',NULL,NULL,NULL,NULL,NULL,TO_TIMESTAMP('25/12/2025 07:09:55','DD/MM/YYYY HH24:MI:SS'),TO_TIMESTAMP('25/12/2025 07:11:10','DD/MM/YYYY HH24:MI:SS'),18266673,'4',NULL,NULL,'TM. Claudia Roj',NULL,NULL,NULL,NULL,NULL,NULL,'N',NULL);

INSERT INTO TAB_RESULTADOS VALUES (6,1,NULL,1416169,15617,2,'03-02-023-00',1,'Creatinina en sangre','0.63','mg/dL','0.50','0.90',NULL,NULL,NULL,TO_TIMESTAMP('25/12/2025 07:11:10','DD/MM/YYYY HH24:MI:SS'),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,'N',NULL);

INSERT INTO TAB_RESULTADOS VALUES (6,1,NULL,1416169,15617,2,'03-02-023-00',2,'Velocidad de filtración glomerular','>60',NULL,NULL,NULL,'
Velocidad de filtración glomerular estimada (MDRD-4).
No utilizar en Insufiencia Renal Aguda, ni en pacientes hospitalizados con función renal inestable.
Método de creatinina estandarizado a Espectrofotometría de masa con Dilución Isotópica.

',NULL,NULL,TO_TIMESTAMP('25/12/2025 07:11:10','DD/MM/YYYY HH24:MI:SS'),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,'N',NULL);

INSERT INTO TAB_RESULTADOS VALUES (6,1,NULL,1416169,15617,3,'03-02-101-00',1,'Albúmina en sangre','2.82','g/dL','3.50','5.20',NULL,NULL,NULL,TO_TIMESTAMP('25/12/2025 07:11:10','DD/MM/YYYY HH24:MI:SS'),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,'L',NULL);

INSERT INTO TAB_RESULTADOS VALUES (6,1,NULL,1416169,15617,4,'03-02-015-00',1,'Calcio en sangre','7.6','mg/dL','8.8','10.2',NULL,NULL,NULL,TO_TIMESTAMP('25/12/2025 07:11:10','DD/MM/YYYY HH24:MI:SS'),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,'L',NULL);

INSERT INTO TAB_RESULTADOS VALUES (6,1,NULL,1416169,15617,5,'03-02-042-00',1,'Fósforo en sangre','2.41','mg/dL','2.50','4.50',NULL,NULL,NULL,TO_TIMESTAMP('25/12/2025 07:11:10','DD/MM/YYYY HH24:MI:SS'),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,'L',NULL);

INSERT INTO TAB_RESULTADOS VALUES (6,1,NULL,1416169,15617,6,'03-02-032-00',1,'Sodio plasmático','143.1','mmol/L','136.0','145.0',NULL,NULL,NULL,TO_TIMESTAMP('25/12/2025 07:11:10','DD/MM/YYYY HH24:MI:SS'),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,'N',NULL);

INSERT INTO TAB_RESULTADOS VALUES (6,1,NULL,1416169,15617,7,'03-02-032-01',1,'Potasio plasmático','3.30','mmol/L','3.50','5.10',NULL,NULL,NULL,TO_TIMESTAMP('25/12/2025 07:11:10','DD/MM/YYYY HH24:MI:SS'),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,'L',NULL);

INSERT INTO TAB_RESULTADOS VALUES (6,1,NULL,1416169,15617,8,'03-02-032-02',1,'Cloro plasmático','106','mmol/L','98','107',NULL,NULL,NULL,TO_TIMESTAMP('25/12/2025 07:11:10','DD/MM/YYYY HH24:MI:SS'),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,'N',NULL);

INSERT INTO TAB_RESULTADOS VALUES (6,1,NULL,1416169,15617,9,'03-02-056-00',1,'Magnesio en sangre','1.96','mg/dL','1.60','2.40',NULL,NULL,NULL,TO_TIMESTAMP('25/12/2025 07:11:11','DD/MM/YYYY HH24:MI:SS'),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,'N',NULL);

INSERT INTO TAB_RESULTADOS VALUES (6,1,NULL,1416169,15617,10,'03-05-031-00',1,'Proteina C reactiva','8.79','mg/dL','0.00','0.49',NULL,NULL,NULL,TO_TIMESTAMP('25/12/2025 07:11:11','DD/MM/YYYY HH24:MI:SS'),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,'H',NULL);

INSERT INTO TAB_RESULTADOS VALUES (6,1,NULL,1416169,15617,11,'03-02-057-03',1,'Urea en sangre','27.9','mg/dL','16.6','48.5',NULL,NULL,NULL,TO_TIMESTAMP('25/12/2025 07:11:11','DD/MM/YYYY HH24:MI:SS'),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,'N',NULL);

INSERT INTO TAB_RESULTADOS VALUES (6,1,NULL,1416169,15617,12,'03-02-057-02',1,'Nitrógeno ureico en sangre','13.0','mg/dL','8.0','23.0','Nota: Por cambio de sistema informático se actualiza el factor de conversión de urea a BUN desde el 05/12/2025.
',NULL,NULL,TO_TIMESTAMP('25/12/2025 07:11:11','DD/MM/YYYY HH24:MI:SS'),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,'N',NULL);

-- Confirmar las inserciones
COMMIT;

-- Crear índices para optimizar consultas
CREATE INDEX IDX_RESULTADOS_ATENCION ON TAB_RESULTADOS(ID_ATENCION);
CREATE INDEX IDX_RESULTADOS_PETICION ON TAB_RESULTADOS(NRO_PETICION_LIS);
CREATE INDEX IDX_RESULTADOS_PRESTACION ON TAB_RESULTADOS(COD_PRESTACION);
CREATE INDEX IDX_RESULTADOS_FECHA_INT ON TAB_RESULTADOS(FECHA_INTEGRACION);

-- Mostrar resumen de registros
SELECT 
    COD_PRESTACION,
    COUNT(*) AS TOTAL_PRUEBAS,
    COUNT(DISTINCT NOMBRE_PRUEBA_LIS) AS PRUEBAS_DISTINTAS
FROM TAB_RESULTADOS
GROUP BY COD_PRESTACION
ORDER BY COD_PRESTACION;

-- Mostrar total de registros
SELECT COUNT(*) AS TOTAL_REGISTROS FROM TAB_RESULTADOS;

-- Mostrar distribución de rangos
SELECT 
    IND_RANGO_RESULTADO,
    CASE 
        WHEN IND_RANGO_RESULTADO = 'N' THEN 'Normal'
        WHEN IND_RANGO_RESULTADO = 'H' THEN 'Alto'
        WHEN IND_RANGO_RESULTADO = 'L' THEN 'Bajo'
        ELSE 'Sin clasificar'
    END AS DESCRIPCION,
    COUNT(*) AS CANTIDAD
FROM TAB_RESULTADOS
GROUP BY IND_RANGO_RESULTADO
ORDER BY IND_RANGO_RESULTADO;

select * from TAB_RESULTADOS order by NOMBRE_PRUEBA_LIS; -- ID_ATENCION  y  cod_prestacion 
